"""
A. –°—É–º–º–∞ –ø—Ä–æ—Å—Ç–∞—è

–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –ø–æ –≤—Ä–µ–º–µ–Ω–∏ –Ω–∞ —Ç–µ—Å—Ç: 1 —Å–µ–∫—É–Ω–¥–∞
–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –ø–æ –ø–∞–º—è—Ç–∏ –Ω–∞ —Ç–µ—Å—Ç: 512 –º–µ–≥–∞–±–∞–π—Ç
–≤–≤–æ–¥: —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –≤–≤–æ–¥
–≤—ã–≤–æ–¥: —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –≤—ã–≤–æ–¥

–í–∞–º –Ω—É–∂–Ω–æ –Ω–∞—É—á–∏—Ç—å—Å—è –æ—Ç–≤–µ—á–∞—Ç—å –Ω–∞ –∑–∞–ø—Ä–æ—Å ¬´—Å—É–º–º–∞ —á–∏—Å–µ–ª –Ω–∞ –æ—Ç—Ä–µ–∑–∫–µ¬ª.

–ú–∞—Å—Å–∏–≤ –Ω–µ –º–µ–Ω—è–µ—Ç—Å—è. –ó–∞–ø—Ä–æ—Å–æ–≤ –º–Ω–æ–≥–æ. –û—Ç–≤–µ—á–∞—Ç—å –Ω–∞ –∫–∞–∂–¥—ã–π –∑–∞–ø—Ä–æ—Å —Å–ª–µ–¥—É–µ—Ç –∑–∞ O(1).

–í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
–†–∞–∑–º–µ—Ä –º–∞—Å—Å–∏–≤–∞ ‚Äî n –∏ —á–∏—Å–ª–∞ x, y, a_0, –ø–æ—Ä–æ–∂–¥–∞—é—â–∏–µ –º–∞—Å—Å–∏–≤ a: a_i=(x‚ãÖa_{i‚àí1}+y)mod2^16
–î–∞–ª–µ–µ —Å–ª–µ–¥—É–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø—Ä–æ—Å–æ–≤ m –∏ —á–∏—Å–ª–∞ z, t, b_0, –ø–æ—Ä–æ–∂–¥–∞—é—â–∏–µ –º–∞—Å—Å–∏–≤ b: b_i=(z‚ãÖb_{i‚àí1}+t)mod2^30.

–ú–∞—Å—Å–∏–≤ c —Å—Ç—Ä–æ–∏—Ç—Å—è —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º: c_i=b_i mod n.

–ó–∞–ø—Ä–æ—Å—ã: i-–π –∏–∑ –Ω–∏—Ö ‚Äî –Ω–∞–π—Ç–∏ —Å—É–º–º—É –Ω–∞ –æ—Ç—Ä–µ–∑–∫–µ –æ—Ç min(c_{2i},c_{2i+1}) –¥–æ max(c_{2i},c_{2i+1}) –≤ –º–∞—Å—Å–∏–≤–µ a.

–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è: 1‚â§n‚â§10^7, 0‚â§m‚â§10^7. –í—Å–µ —á–∏—Å–ª–∞ —Ü–µ–ª—ã–µ –æ—Ç 0 –¥–æ 2^16. t –º–æ–∂–µ—Ç –±—ã—Ç—å —Ä–∞–≤–Ω–æ ‚àí1.

–í—ã—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
–í—ã–≤–µ–¥–∏—Ç–µ —Å—É–º–º—É –≤—Å–µ—Ö —Å—É–º–º.

–ü—Ä–∏–º–µ—Ä
–≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
3 1 2 3
3 1 -1 4
–≤—ã—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
23

–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ
ùëé={3,5,7},ùëè={4,3,2,1,0,230‚àí1},ùëê={1,0,2,1,0,0},
–∑–∞–ø—Ä–æ—Å—ã = {[0,1],[1,2],[0,0]}, —Å—É–º–º—ã = {8,12,3}.

–ü—Ä–µ—Ñ–∏–∫—Å–Ω—ã–µ —Å—É–º–º—ã, –∫–∞–∫ –Ω–∞ –ª–µ–∫—Ü–∏–∏
"""
MOD_1 = (1 << 16)
MOD_2 = (1 << 30)


def simple_sum_solution(n, x, y, a0, m, z, t, b0):
    if m == 0:
        return 0

    a = [0] * n
    a_sum = [0] * n
    a[0] = a0
    a_sum[0] = a0
    for i in range(1, n):
        a[i] = (x * a[i - 1] + y) % MOD_1
        a_sum[i] = a_sum[i - 1] + a[i]

    b = [0] * 2 * m
    c = [0] * 2 * m
    b[0] = b0
    c[0] = b0 % n
    for j in range(1, 2 * m):
        b[j] = (z * b[j - 1] + t) % MOD_2
        c[j] = b[j] % n

    common_sum = 0
    for query_num in range(m):
        left = min(c[2 * query_num], c[2 * query_num + 1])
        right = max(c[2 * query_num], c[2 * query_num + 1])
        if left == 0:
            query_sum = a_sum[right]
        else:
            query_sum = a_sum[right] - a_sum[left - 1]
        common_sum += query_sum

    return common_sum


def main():
    n, x, y, a0 = map(int, input().split())
    m, z, t, b0 = map(int, input().split())
    print(simple_sum_solution(n, x, y, a0, m, z, t, b0))


if __name__ == "__main__":
    main()
